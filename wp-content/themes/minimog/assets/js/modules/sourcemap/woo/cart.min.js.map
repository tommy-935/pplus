{"version":3,"sources":["cart.js"],"names":["$","Helpers","window","minimog","$cartTable","document","ready","timeout","on","$qty","this","get","reportValidity","undefined","clearTimeout","setTimeout","cart_item_key","cart_item_qty","itemKey","attr","itemQty","val","data","security","$minimog","nonce","ajax","url","$minimogWoo","wc_ajax_url","toString","replace","type","cache","dataType","beforeSend","setBodyHandling","error","setBodyCompleted","success","response","fragments","each","key","value","replaceWith","body","trigger","handleLazyImages","$form","$submitButton","find","notes","order_notes","setElementHandling","complete","unsetElementHandling","closest","MinimogModal","evt","preventDefault","currentTarget","serialize","empty","$newElement","parseHTML","html","$thisButton","wc_add_to_cart_params","getAjaxUrl","output","cart_hash","location","jQuery"],"mappings":"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","file":"../../../woo/cart.min.js","sourcesContent":["(\n\tfunction( $ ) {\n\t\t'use strict';\n\n\t\tvar Helpers = window.minimog.Helpers;\n\n\t\tvar $cartTable = $( '#cart-table-wrap' );\n\n\t\t$( document ).ready( function() {\n\t\t\tinitCart();\n\t\t} );\n\n\t\t$( document.body ).on( 'wc_fragments_loaded wc_fragments_refreshed', function() {\n\t\t\tHelpers.handleLazyImages( $cartTable );\n\t\t\tHelpers.setBodyCompleted();\n\t\t} );\n\n\t\t$( '#modal-cart-order-notes' ).on( 'submit', 'form', save_order_notes );\n\n\t\t$( document ).on( 'submit', 'form.fly-cart-shipping-calculator', shipping_calculator_submit );\n\n\t\t$( document ).on( 'click', '.btn-remove-from-cart', remove_from_cart );\n\n\t\tfunction initCart() {\n\t\t\tvar timeout;\n\t\t\t$cartTable.on( 'change', '.qty', function() {\n\t\t\t\tvar $qty = $( this );\n\n\t\t\t\tif ( ! $qty.get( 0 ).reportValidity() ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( timeout !== undefined ) {\n\t\t\t\t\tclearTimeout( timeout );\n\t\t\t\t}\n\n\t\t\t\ttimeout = setTimeout( function() {\n\t\t\t\t\tvar itemKey = $qty.attr( 'name' );\n\t\t\t\t\tvar itemQty = $qty.val();\n\n\t\t\t\t\tupdate_quantity( itemKey, itemQty );\n\t\t\t\t}, 500 );\n\t\t\t} );\n\t\t}\n\n\t\tfunction remove_from_cart( evt ) {\n\t\t\t/**\n\t\t\t * Check if Enable AJAX add to cart buttons on archives.\n\t\t\t */\n\t\t\tif ( typeof wc_add_to_cart_params === 'undefined' ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevt.preventDefault();\n\n\t\t\tvar $thisButton = $( this );\n\n\t\t\t$.ajax( {\n\t\t\t\ttype: 'POST',\n\t\t\t\turl: Helpers.getAjaxUrl( 'remove_from_cart' ),\n\t\t\t\tdata: {\n\t\t\t\t\tcart_item_key: $thisButton.data( 'cart_item_key' )\n\t\t\t\t},\n\t\t\t\tdataType: 'json',\n\t\t\t\tbeforeSend: function() {\n\t\t\t\t\tHelpers.setBodyHandling();\n\t\t\t\t},\n\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\tif ( ! response || ! response.fragments ) {\n\t\t\t\t\t\twindow.location = $thisButton.attr( 'href' );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Updated cart content.\n\t\t\t\t\tif ( response.output ) {\n\t\t\t\t\t\t$.each( response.output, function( key, value ) {\n\t\t\t\t\t\t\t$( key ).replaceWith( value );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t$( document.body ).trigger( 'removed_from_cart', [\n\t\t\t\t\t\tresponse.fragments, response.cart_hash, $thisButton\n\t\t\t\t\t] );\n\n\t\t\t\t\tHelpers.setBodyCompleted();\n\t\t\t\t\tHelpers.handleLazyImages( $cartTable );\n\t\t\t\t},\n\t\t\t\terror: function() {\n\t\t\t\t\twindow.location = $thisButton.attr( 'href' );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\tfunction update_quantity( cart_item_key, cart_item_qty ) {\n\t\t\tvar data = {\n\t\t\t\tcart_item_key: cart_item_key,\n\t\t\t\tcart_item_qty: cart_item_qty,\n\t\t\t\tsecurity: $minimog.nonce,\n\t\t\t};\n\n\t\t\t$.ajax( {\n\t\t\t\turl: $minimogWoo.wc_ajax_url.toString().replace( '%%endpoint%%', 'minimog_update_product_quantity' ),\n\t\t\t\ttype: 'POST',\n\t\t\t\tcache: false,\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: data,\n\t\t\t\tbeforeSend: function() {\n\t\t\t\t\tHelpers.setBodyHandling();\n\t\t\t\t},\n\t\t\t\terror: function() {\n\t\t\t\t\tHelpers.setBodyCompleted();\n\t\t\t\t},\n\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\tif ( response.data && response.data.fragments ) {\n\t\t\t\t\t\t$.each( response.data.fragments, function( key, value ) {\n\t\t\t\t\t\t\t$( key ).replaceWith( value );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t$( document.body ).trigger( 'minimog_update_qty', [ cart_item_key, cart_item_qty ] );\n\n\t\t\t\t\t$( document.body ).trigger( 'wc_fragment_refresh' );\n\t\t\t\t},\n\t\t\t} );\n\t\t}\n\n\t\tfunction save_order_notes() {\n\t\t\tvar $form         = $( this );\n\t\t\tvar $submitButton = $form.find( 'button[type=submit]' );\n\n\t\t\tvar notes = $( this ).find( 'textarea[name=\"order_comments\"]' ).val();\n\n\t\t\tvar data = {\n\t\t\t\torder_notes: notes,\n\t\t\t};\n\n\t\t\t$.ajax( {\n\t\t\t\ttype: 'POST',\n\t\t\t\turl: $minimogWoo.wc_ajax_url.toString().replace( '%%endpoint%%', 'minimog_save_order_notes' ),\n\t\t\t\tdata: data,\n\t\t\t\tdataType: 'json',\n\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\tif ( response.data && response.data.fragments ) {\n\t\t\t\t\t\t$.each( response.data.fragments, function( key, value ) {\n\t\t\t\t\t\t\t$( key ).replaceWith( value );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Sync notes on other places.\n\t\t\t\t\t$( 'textarea[name=\"order_comments\"]' ).val( notes );\n\t\t\t\t},\n\t\t\t\tbeforeSend: function() {\n\t\t\t\t\tHelpers.setElementHandling( $submitButton );\n\t\t\t\t},\n\t\t\t\tcomplete: function() {\n\t\t\t\t\tHelpers.unsetElementHandling( $submitButton );\n\t\t\t\t\t$form.closest( '.minimog-modal' ).MinimogModal( 'close' );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\treturn false;\n\t\t}\n\n\t\t/**\n\t\t * Clone from wc-cart\n\t\t * Handles a shipping calculator form submit.\n\t\t *\n\t\t * @param {Object} evt The JQuery event.\n\t\t */\n\t\tfunction shipping_calculator_submit( evt ) {\n\t\t\tevt.preventDefault();\n\n\t\t\tvar $form = $( evt.currentTarget );\n\n\t\t\t$.ajax( {\n\t\t\t\ttype: $form.attr( 'method' ),\n\t\t\t\turl: $minimogWoo.wc_ajax_url.toString().replace( '%%endpoint%%', 'minimog_calculate_shipping' ),\n\t\t\t\tdata: $form.serialize(),\n\t\t\t\tdataType: 'json',\n\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\tif ( response.data.fragments ) {\n\t\t\t\t\t\t$.each( response.data.fragments, function( key, value ) {\n\t\t\t\t\t\t\t$( key ).empty();\n\n\t\t\t\t\t\t\tif ( '' !== value ) {\n\t\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t\t * Append only children.\n\t\t\t\t\t\t\t\t * Avoid to use replaceWith to lost \"key\" events\n\t\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\t\tvar $newElement = $( $.parseHTML( value ) );\n\t\t\t\t\t\t\t\t$( key ).html( $newElement.html() );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tbeforeSend: function() {\n\t\t\t\t\t$form.closest( '.minimog-modal' ).MinimogModal( 'close' );\n\t\t\t\t\tHelpers.setBodyHandling();\n\t\t\t\t},\n\t\t\t\tcomplete: function() {\n\t\t\t\t\tHelpers.setBodyCompleted();\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}( jQuery )\n);\n"]}